{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst formSearch = document.querySelector('.form');\nconst imageList = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\n\nconst gallery = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nlet page = 1;\nlet currentSearchQuery = ''; // Додайте глобальну змінну для зберігання поточного тегу\n\nformSearch.addEventListener('submit', handleSearch);\nloadMoreBtn.addEventListener('click', loadMoreImages);\n\nfunction handleSearch(event) {\n    event.preventDefault();\n    const searchQuery = event.currentTarget.elements.input.value;\n\n    imageList.innerHTML = '';\n    loader.classList.remove('is-hidden');\n    page = 1;\n    currentSearchQuery = searchQuery;\n\n    if (!searchQuery.trim()) {\n        iziToast.warning({\n            message: 'Please, fill in the search field',\n            position: 'topLeft',\n            timeout: 3000,\n        });\n        loader.classList.add('is-hidden');\n        return;\n    }\n\n    fetchImages(searchQuery)\n        .then(data => {\n            if (data.hits.length === 0) {\n                iziToast.error({\n                    message: 'Sorry, there are no images matching your search query. Please try again!',\n                    position: 'topRight',\n                    timeout: 5000,\n                });\n            }\n            imageList.innerHTML = createMarkup(data.hits);\n            gallery.refresh();\n            showLoadMoreButton(data.hits.length, data.totalHits);\n        })\n        .catch(handleError)\n        .finally(() => {\n            loader.classList.add('is-hidden');\n            showLoadMoreButton(15, data.totalHits);\n        });\n  event.currentTarget.reset();\n}\n\nfunction fetchImages(value) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const perPage = 15;\n\n  const searchParams = new URLSearchParams({\n    key: '42027170-68cc294651d415255967a4fd3',\n    q: value,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: perPage,\n  });\n\n  return fetch(`${BASE_URL}/?${searchParams}`).then(res => {\n    if (!res.ok) {\n      throw new Error(res.status);\n    }\n    return res.json();\n  });\n}\n\nfunction createMarkup(arr) {\n  return arr\n    .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n      `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n           <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n        </a>\n        <div class=\"container-additional-info\">\n          <div class=\"container-descr-inner\"><p class=\"description\">Likes</p><span class=\"description-value\">${likes}</span></div>\n          <div class=\"container-descr-inner\"><p class=\"description\">Views</p><span class=\"description-value\">${views}</span></div>\n          <div class=\"container-descr-inner\"><p class=\"description\">Comments</p><span class=\"description-value\">${comments}</span></div>\n          <div class=\"container-descr-inner\"><p class=\"description\">Downloads</p><span class=\"description-value\">${downloads}</span></div>\n        </div>\n      </li>`\n    )\n    .join('');\n}\n\nfunction handleError(err) {\n  console.error(err);\n  imageList.innerHTML = '';\n  iziToast.error({\n    message: 'Sorry, there is a problem with the connection with the server.',\n    position: 'center',\n    timeout: 5000,\n  });\n}\n\nfunction loadMoreImages() {\n    page++;\n    loader.classList.remove('is-hidden'); \n  const galleryItemHeight = document.querySelector('.gallery-item').getBoundingClientRect().height;\n  fetchImages(currentSearchQuery) \n    .then(data => {\n      if (data.hits.length > 0) {\n        const newImagesMarkup = createMarkup(data.hits);\n        imageList.insertAdjacentHTML('beforeend', newImagesMarkup);\n        gallery.refresh();\n        const scrollDistance = galleryItemHeight * 2;\n        window.scrollBy({\n          top: scrollDistance,\n          behavior: 'smooth',\n        });\n      }\n      showLoadMoreButton(data.hits.length, data.totalHits);\n    })\n      .catch(handleError)\n    .finally(() => {\n      loader.classList.add('is-hidden'); \n    });\n}\n\nfunction showLoadMoreButton(imagesCount, totalHits) {\n  if (imagesCount >= 15 && totalHits && page * 15 < totalHits) {\n    loadMoreBtn.style.display = 'block';\n  } else {\n    loadMoreBtn.style.display = 'none';\n    if (totalHits && page * 15 >= totalHits) {\n      showEndOfResultsMessage();\n    }\n  }\n}\n\nfunction showEndOfResultsMessage() {\n  iziToast.info({\n    message: \"We're sorry, but you've reached the end of search results.\",\n    position: 'bottomCenter',\n    timeout: 5000,\n  });\n}\n\n"],"names":["formSearch","imageList","loader","loadMoreBtn","gallery","SimpleLightbox","page","currentSearchQuery","handleSearch","loadMoreImages","event","searchQuery","iziToast","fetchImages","data","createMarkup","showLoadMoreButton","handleError","value","BASE_URL","searchParams","res","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","err","galleryItemHeight","newImagesMarkup","scrollDistance","imagesCount","totalHits","showEndOfResultsMessage"],"mappings":"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"}